version: '3'

includes:
  terraform:
    taskfile: terraform/Taskfile.yml
    dir: .
  ansible:
    taskfile: ansible/Taskfile.yml

env:
  REPO_ROOT: "{{.PWD}}"

tasks:
  deploy:
    desc: Full infra + config deployment
    cmds:
      - echo "ğŸš€ Starting deployment"
      - task terraform:apply
      - task ansible:deploy
      - echo "âœ… Deployment complete"

  check:
    desc: Safe dry-run
    cmds:
      - echo "ğŸ” Dry run"
      - task terraform:plan
      - task ansible:check

  destroy:
    desc: Tear everything down
    cmds:
      - echo "âš ï¸ Destroying infrastructure"
      - task terraform:destroy
      - echo "ğŸ’¥ Infrastructure destroyed"

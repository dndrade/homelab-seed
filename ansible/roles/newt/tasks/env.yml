# {{ ansible_managed }}

# ==========================================
#        Required environment vars
# ==========================================

- name: Assert Newt secrets are provided
  ansible.builtin.assert:
    that:
      - newt_id | default('') | length > 0
      - newt_api_token | default('') | length > 0
    fail_msg: >
      Missing required Newt environment variables.
      Required:
        - newt_id
        - newt_api_token
      These must be provided via env. or encrypt files (e.g. GitHub Secrets).

# ==========================================
#        Load secrets into Ansible facts
# ==========================================

- name: Load Newt secrets from environment # noqa: var-naming[no-role-prefix]
  ansible.builtin.set_fact:
    newt_id: "{{ newt_id }}"
    newt_api_token: "{{ newt_api_token }}"

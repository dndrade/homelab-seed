---
#
# Docker edition
# allows CE/EE switching without task changes
# =====================================================

# Edition can be: 'ce' or 'ee'
docker_edition: "ce"


#
# Docker packages
# install a complete, future-proof Docker toolchain
# =====================================================

# Packages (Ubuntu / Debian)
docker_packages:
  - "docker-{{ docker_edition }}"
  - "docker-{{ docker_edition }}-cli"
  - "docker-{{ docker_edition }}-rootless-extras"
  - "containerd.io"
  - docker-buildx-plugin
  - docker-compose-plugin

docker_packages_state: present


#
# Obsolete / conflicting packages
# prevents mixed Docker implementations
# =====================================================

docker_obsolete_packages:
  - docker
  - docker.io
  - docker-engine
  - docker-doc
  - docker-compose
  - docker-compose-v2
  - podman-docker
  - containerd
  - runc

#
# Docker service management
# =====================================================

docker_service_manage: true
docker_service_state: started
docker_service_enabled: true

# Handler state if we ever notify a restart
docker_restart_handler_state: restarted


#
# Docker Compose configuration
# =====================================================

docker_install_compose_plugin: true
docker_compose_package: docker-compose-plugin
docker_compose_package_state: present

# Legacy Compose v1 (currently disabled)
docker_install_compose: false


#
# Docker APT repository configuration
# =====================================================

docker_add_repo: true
docker_repo_url: https://download.docker.com/linux
docker_apt_release_channel: stable

# Handle Ubuntu derivatives cleanly
docker_apt_ansible_distribution: >-
  {{ 'ubuntu'
     if ansible_distribution in ['Pop!_OS', 'Linux Mint']
     else ansible_distribution }}

# Architecture mapping
docker_apt_arch: >-
  {{ 'arm64' if ansible_architecture == 'aarch64'
     else 'armhf' if ansible_architecture == 'armv7l'
     else 'amd64' }}

docker_apt_keyring_dir: /etc/apt/keyrings
docker_apt_key_asc: "{{ docker_apt_keyring_dir }}/docker.asc"
docker_apt_key_gpg: "{{ docker_apt_keyring_dir }}/docker.gpg"
docker_apt_gpg_key_url: >-
  {{ docker_repo_url }}/{{ docker_apt_ansible_distribution | lower }}/gpg

# (deb822 kept for future migration, unused for now)
docker_deb822_name: docker
docker_deb822_file: "/etc/apt/sources.list.d/{{ docker_deb822_name }}.sources"


#
# Docker users
# =====================================================

docker_users:
  - "{{ ansible_user }}"

#
# Docker daemon configuration
# =====================================================

# Empty by default â†’ daemon.json is NOT written
docker_daemon_options: {}
